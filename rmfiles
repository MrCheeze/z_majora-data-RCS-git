#!/bin/sh
#
# 削除するファイルの登録
# 登録は後ろに追加するようにし、
# １ヶ月をめどに消去する
#
#$Log$
#Revision 2.7  2000-01-15 18:45:11+09  iwawaki
#*** empty log message ***
#
#Revision 2.6  1999-09-01 20:18:11+09  iwawaki
#*** empty log message ***
#
#Revision 2.5  1999-09-01 18:42:39+09  iwawaki
#*** empty log message ***
#
#Revision 2.4  1999-09-01 18:40:28+09  iwawaki
#*** empty log message ***
#
#Revision 2.3  1999-09-01 15:04:18+09  iwawaki
#*** empty log message ***
#
#Revision 2.2  1999-01-27 10:32:17+09  iwawaki
#*** empty log message ***
#
#Revision 2.1  1998-10-22 21:42:44+09  hayakawa
#ＲＯＭ出しバージョン(NTSC)
#
#Revision 1.7  1998-10-09 16:52:01+09  komatu
#*** empty log message ***
#
#Revision 1.6  1998-06-18 13:07:56+09  komatu
#OF1をけした
#
#Revision 1.5  1998-06-01 19:12:49+09  hayakawa
#hidan_objects4.o
#hidan_objects5.o
#hidan_objects6.o
#
#Revision 1.4  1998-01-20 16:58:41+09  soejima
#*** empty log message ***
#
# Revision 1.3  1997/10/13  13:21:41  soejima
# *** empty log message ***
#
# Revision 1.2  1997/10/11  06:59:02  soejima
# *** empty log message ***
#
# Revision 1.1  1997/09/03  06:03:11  soejima
# Initial revision
#
#

#set -x

#
#ファイルはここに登録
#
RMFILES="
hidan_objects4.o
hidan_objects5.o
hidan_objects6.o
opening
opening.map
opening.objs
map_pal.o
message
message.objs
map_make
title
title.map
title.objs
parameter
parameter.map
parameter.objs
parameter.objs~
parameter~
nintendo_rogo
OF1.o
gjyo_objects.o
Baby_skel.o
Ironknack.o
Soldier.o
Human.o
Fire.o
Reeba.o
Kdodongo.o
Kdodongo_PAL.o
Zf.o
Go.o
Go_PAL.o
Gol.o
Dodojr.o
Tp.o
OAX.o
Ei.o
OBX.o
O_anime.o
OA2.o
spot00_objects.o
Mb.o
Sk2.o
OE1.o
OE_anime.o
OE2.o
Gnd.o
OA3.o
OA4.o
OA5.o
OA6.o
OA7.o
OA8.o
OA9.o
OB2.o
OB3.o
OB4.o
Horse_Ganon.o
Horse_Zelda.o
Opening_Demo1.o
OE3.o
OE4.o
menkuri_objects.o
OE5.o
OE6.o
OE7.o
OE8.o
OE9.o
OE10.o
OE11.o
OE12.o
OA10.o
OA11.o
Yukabyun.o
Mjin.o
Flash_mjin.o
Dark_mjin.o
Flame_mjin.o
Ice_mjin.o
Soul_mjin.o
Wind_mjin.o
Oka_mjin.o
Po_Composer.o
Warp2.o
Bird.o
Lightbox.o
Pu_box.o
Vase.o
Im.o
Tk.o
Bv.o
Bv_PAL.o
efc_crystal_light.o
efc_fire_ball.o
efc_flash.o
efc_lgt_shower.o
god_lgt.o
light_ring.o
triforce_spot.o
Gndd.o
fd.o
fd_PAL.o
fw.o
medal.o
Haka.o
ru1.o
fd2.o
Rl.o
demo_tre_lgt.o
gi_jewel.o
nb.o
mo.o
mo_PAL.o
gi_medal.o
Tr.o
oE1s.o
oE4s.o
oF1s.o
tw.o
tw_PAL.o
bxa.o
Av.o
gi_gerudo.o
B_ganon.o
B_ganon_PAL.o
Sst.o
Sst_PAL.o
Go2.o
gi_pachinko.o
gi_grass.o
Gate.o
Kw1.o
Ik.o
gi_ocarina_0.o
gi_boots_2.o
gnd_magic.o
d_elevator.o
Ingate.o
gi_gloves.o
gi_coin.o
fa.o
gi_bracelet.o
efc_erupc.o
Zl2_Anime2.o
B_ganon2.o
B_ganon2_PAL.o
gi_hoverboots.o
Ec.o
ssh.o
spot00_break.o
Gla.o
gi_butterfly.o
Ganon_Anime1.o
Ganon_Anime2.o
Ganon_Anime3.o
killer_door.o
swfl.o
Skje.o
Stain.o
Dno.o
G_pn_19.o
G_pn_20.o
G_pn_21.o
G_pn_24.o
G_pn_29.o
G_pn_32.o
G_pn_43.o
G_pn_44.o
G_pn_46.o
G_pn_54.o
"

echo "使用しなくなったソースを削除します…"

backup_depend() {
  if [ -f $1 ]
  then
    echo $1 を /tmp/rmfiles_$1.$$ にバックアップします
    cp $1 /tmp/rmfiles_$1.$$
  fi
}

delete_depend() {
  if [ -f $2 ]
  then
    echo $1 を $2 から抹消します
    sed -e "s*\.\./$1**" $2 > /tmp/rmfiles.$$
    cp /tmp/rmfiles.$$ $2
    rm -f /tmp/rmfiles.$$
  fi
}

delete_source() {
  if [ -f $1 ]
  then
    delete_depend $1 Makedepend
    delete_depend $1 rom_d/Makedepend
    delete_depend $1 rom_rom/Makedepend
    echo $1 を 削除します
    mv $1 $1.deleted
  fi
  if [ -f RCS/$1,v ]
  then
    echo RCS/$1,v を 削除します
    mv RCS/$1,v RCS/$1,v.deleted
  fi
}


echo ""
echo ""
echo ""
echo ""
echo ""

for file in $RMFILES
do
    delete_source $file
done


echo '本当に削除するには、\\rm -f *.deleted を実行してください。'
echo ""

echo "ここで、rmfilesの説明をします"
echo "ＲＣＳ管理していたファイルが不要になった場合"
echo "管理ファイルだけを消しても不十分です。"
echo "他の人がそのファイルをチェックアウトしようとして登録されてしまうのです。"
echo "つまり、コピーされたファイルも含め、完全に消さないとだめなのです。"
echo "で、どうするかというとrmfilesに消したいファイル名を登録して、"
echo "rmfilesをチェックインすれば、他の人がcoallしたときに自動的に削除されます。"
echo "わかった？（はい／うん）"

echo ""
echo ""
echo ""
echo ""
echo ""
